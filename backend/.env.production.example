# =============================================================================
# Turbocat Backend - Production Environment Variables
# =============================================================================
# PRODUCTION DEPLOYMENT TEMPLATE
# Copy this file to .env.production and fill in your production values
# NEVER commit actual production secrets to version control!
# =============================================================================

# =============================================================================
# DATABASE (Supabase PostgreSQL - Production)
# =============================================================================
# IMPORTANT: Use production Supabase project credentials
# Get these from your Supabase project: Settings > Database > Connection string
#
# For production, ensure connection pooling is properly configured
# Consider using Supabase's connection pooler for serverless deployments
#
DATABASE_URL="postgresql://postgres.[YOUR-PROD-PROJECT-REF]:[YOUR-PROD-PASSWORD]@aws-0-[REGION].pooler.supabase.com:6543/postgres?pgbouncer=true&connection_limit=20"
DIRECT_URL="postgresql://postgres.[YOUR-PROD-PROJECT-REF]:[YOUR-PROD-PASSWORD]@aws-0-[REGION].pooler.supabase.com:5432/postgres"

# =============================================================================
# SUPABASE (Production)
# =============================================================================
# Get these from your production Supabase project: Settings > API
#
SUPABASE_URL="https://[YOUR-PROD-PROJECT-REF].supabase.co"
SUPABASE_ANON_KEY="your-production-supabase-anon-key"
SUPABASE_SERVICE_ROLE_KEY="your-production-supabase-service-role-key"

# =============================================================================
# JWT AUTHENTICATION (Production Secrets)
# =============================================================================
# CRITICAL: Generate STRONG secrets for production!
# Use cryptographically secure random generators:
#
# Node.js (recommended):
#   node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
#
# PowerShell:
#   [Convert]::ToBase64String([System.Security.Cryptography.RandomNumberGenerator]::GetBytes(64))
#
# OpenSSL (if available):
#   openssl rand -hex 64
#
# REQUIREMENTS:
# - At least 64 bytes (128 hex characters) for each secret
# - Different secrets for access and refresh tokens
# - Never reuse secrets across environments
#
JWT_ACCESS_SECRET="GENERATE_STRONG_64_BYTE_HEX_SECRET_FOR_ACCESS_TOKENS"
JWT_REFRESH_SECRET="GENERATE_STRONG_64_BYTE_HEX_SECRET_FOR_REFRESH_TOKENS"
JWT_ACCESS_EXPIRY="15m"
JWT_REFRESH_EXPIRY="7d"

# =============================================================================
# ENCRYPTION (Production Key)
# =============================================================================
# Used for encrypting sensitive data at rest (API keys, credentials, etc.)
# CRITICAL: Generate a strong key and store it securely!
#
# Generate using:
#   node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
#
ENCRYPTION_KEY="GENERATE_STRONG_32_BYTE_HEX_ENCRYPTION_KEY"

# =============================================================================
# REDIS (Production)
# =============================================================================
# For production, use a managed Redis service:
#
# Recommended options (cost-effective):
# 1. Upstash Redis (serverless, pay-per-request): https://upstash.com
#    Format: rediss://default:[PASSWORD]@[ENDPOINT]:6379
#
# 2. Railway Redis: https://railway.app
#    Format: redis://default:[PASSWORD]@[HOST]:6379
#
# 3. Redis Cloud (free tier available): https://redis.com/try-free/
#
# Enable TLS for production connections (use rediss:// prefix)
#
REDIS_URL="rediss://default:[YOUR-REDIS-PASSWORD]@[YOUR-REDIS-ENDPOINT]:6379"

# =============================================================================
# APPLICATION (Production Settings)
# =============================================================================
NODE_ENV="production"
PORT=3001
HOST="0.0.0.0"

# Frontend URL (update to your production frontend domain)
FRONTEND_URL="https://your-production-domain.com"

# Additional allowed origins for CORS (comma-separated)
ALLOWED_ORIGINS="https://your-production-domain.com,https://www.your-production-domain.com"

# API versioning
API_VERSION="v1"

# =============================================================================
# LOGGING (Production)
# =============================================================================
# Recommended: Use 'info' for production to reduce log volume
# Use 'warn' or 'error' for minimal logging
LOG_LEVEL="info"

# Structured JSON logging for production (easier to parse)
LOG_FORMAT="json"

# =============================================================================
# RATE LIMITING (Production)
# =============================================================================
# Stricter limits for production to prevent abuse
RATE_LIMIT_MAX=100
RATE_LIMIT_WINDOW_MINUTES=15

# Per-user rate limiting
USER_RATE_LIMIT_MAX=1000
USER_RATE_LIMIT_WINDOW_MINUTES=60

# =============================================================================
# SECURITY (Production)
# =============================================================================
# Trust proxy (required behind load balancers like Railway, Render, etc.)
TRUST_PROXY=true

# Secure cookies (must be true in production with HTTPS)
SECURE_COOKIES=true

# Session configuration
SESSION_SECRET="GENERATE_STRONG_32_BYTE_HEX_SESSION_SECRET"

# =============================================================================
# ERROR TRACKING (Optional but Recommended)
# =============================================================================
# Sentry for error tracking (free tier: 5k errors/month)
# Get your DSN from: https://sentry.io
#
# SENTRY_DSN="https://[KEY]@[ORG].ingest.sentry.io/[PROJECT_ID]"

# =============================================================================
# PERFORMANCE MONITORING (Optional)
# =============================================================================
# Application performance monitoring
# Options: New Relic, Datadog, or use Sentry Performance
#
# NEWRELIC_LICENSE_KEY="your-newrelic-license-key"
# NEWRELIC_APP_NAME="turbocat-backend-production"

# =============================================================================
# HEALTH CHECK
# =============================================================================
# Health check configuration for load balancers
HEALTH_CHECK_PATH="/health"
HEALTH_CHECK_INTERVAL=30000

# =============================================================================
# DEPLOYMENT INFO (Set by CI/CD)
# =============================================================================
# These are typically set automatically by your deployment platform
# APP_VERSION="1.0.0"
# DEPLOYMENT_ID="deployment-id-from-platform"
# GIT_COMMIT="git-commit-sha"
